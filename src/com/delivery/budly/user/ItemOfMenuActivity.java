package com.budly.android.CustomerApp.user;import java.util.ArrayList;import android.graphics.Color;import android.os.Bundle;import android.util.Log;import android.view.View;import android.view.ViewGroup;import android.widget.BaseAdapter;import android.widget.Button;import android.widget.ImageView;import android.widget.LinearLayout;import android.widget.ListView;import android.widget.TextView;import android.widget.Toast;import com.budly.BaseActivity;import com.budly.R;import com.budly.android.CustomerApp.beans.MenuItem;import com.budly.android.CustomerApp.beans.MenuSupplier;import com.nostra13.universalimageloader.core.DisplayImageOptions;import com.nostra13.universalimageloader.core.ImageLoader;import com.nostra13.universalimageloader.core.display.RoundedBitmapDisplayer;public class ItemOfMenuActivity extends BaseActivity implements		View.OnClickListener {	MyAdapter adapter;	ImageView btn_left, thumb;	Button btn_next;	ListView listView;	TextView txt_des;	ArrayList<MenuItem> mList = new ArrayList<MenuItem>();		// Khai bao options display image	DisplayImageOptions options = new DisplayImageOptions.Builder()		.showStubImage(R.drawable.thumb1)		.showImageForEmptyUri(R.drawable.thumb1)		.showImageOnFail(R.drawable.thumb1)		.displayer(new RoundedBitmapDisplayer(200))		.cacheInMemory(false).cacheOnDisc(true).build();	public void onClick(View paramView) {		switch (paramView.getId()) {		default:			break;		case R.id.btn_left:			finish();			return;		case R.id.btn_next:			finish();			break;		}	}	int mPos;	int mSupplierId;	int distance;	String mSupplierName, mthumb;	TextView total, title, txt_mile, txt_menu_item_name;	MenuSupplier menuSupplier;	protected void onCreate(Bundle paramBundle) {		super.onCreate(paramBundle);		setContentView(R.layout.user_activity_item_of_menu);		thumb = (ImageView) findViewById(R.id.thumb);		this.btn_next = ((Button) findViewById(R.id.btn_next));		this.btn_left = ((ImageView) findViewById(R.id.btn_left));		this.btn_next.setOnClickListener(this);		this.btn_left.setOnClickListener(this);		txt_menu_item_name = (TextView) findViewById(R.id.txt_menu_item_name);		this.listView = ((ListView) findViewById(R.id.list));		total = (TextView) findViewById(R.id.total);		title = (TextView) findViewById(R.id.title);		txt_mile = (TextView) findViewById(R.id.txt_mile);		txt_des = (TextView) findViewById(R.id.txt_des);				int mPos = getIntent().getIntExtra("position", -1);		Log.i("Tuan", "Select item "+mPos);		mSupplierId = getIntent().getIntExtra("supplier_id", -1);		mSupplierName = getIntent().getStringExtra("supplier_name");		distance = getIntent().getIntExtra("distance", 0);		if(mPos<0) {			Toast.makeText(this, "Select invalid", Toast.LENGTH_SHORT).show();		}				mthumb = getIntent().getStringExtra("thumb");				ImageLoader.getInstance().displayImage(mthumb, thumb, options);				txt_mile.setText(distance+" Miles");		menuSupplier = MenuOfServiceActivity.mList.get(mPos);		txt_des.setText(menuSupplier.desc);		txt_menu_item_name.setText(menuSupplier.name);		title.setText(mSupplierName);		txt_mile.setText(" miles");		mList = menuSupplier.items;		this.adapter = new MyAdapter();		this.listView.setAdapter(this.adapter);		adapter.notifyDataSetChanged();	}	class MyAdapter extends BaseAdapter {		MyAdapter() {		}		public int getCount() {			return ItemOfMenuActivity.this.mList.size();		}		public Object getItem(int paramInt) {			return null;		}		public long getItemId(int paramInt) {			return 0L;		}				public View getView(int paramInt, View paramView,				ViewGroup paramViewGroup) {			View localView = paramView;			MyHolder holder = null;			if (localView == null) {				localView = ItemOfMenuActivity.this.getLayoutInflater()						.inflate(R.layout.user_menu_item1, paramViewGroup, false);				holder = new ItemOfMenuActivity.MyHolder();				holder.title = ((TextView) localView						.findViewById(R.id.title));				holder.price = ((TextView) localView						.findViewById(R.id.txt_price));				holder.btn_minus = ((ImageView) localView						.findViewById(R.id.btn_minus));				holder.btn_plus = ((ImageView) localView						.findViewById(R.id.btn_plus));				holder.quality = ((TextView) localView						.findViewById(R.id.quality));				holder.layout = ((LinearLayout) localView						.findViewById(R.id.menu_item_layout));				localView.setTag(holder);			} else {				holder = (MyHolder) localView.getTag();			}			final MenuItem item = (MenuItem) ItemOfMenuActivity.this.mList.get(paramInt);			holder.title.setText(item.size);			holder.price.setText(String.valueOf(item.price));			holder.quality.setText(String.valueOf(item.quality));			holder.btn_minus.setOnClickListener(new View.OnClickListener() {				public void onClick(View paramAnonymousView) {					if (item.quality > 0) {						item.quality = (-1 + item.quality);						ItemOfMenuActivity.this.adapter.notifyDataSetChanged();					}				}			});			holder.btn_plus.setOnClickListener(new View.OnClickListener() {				public void onClick(View paramAnonymousView) {					if (item.quality < 100) {						item.quality = (1 + item.quality);						adapter.notifyDataSetChanged();					}				}			});			holder.layout.setBackgroundColor(Color.parseColor("#aaffffff"));			return localView;		}		@Override		public void notifyDataSetChanged() {			double tt = 0;			for (int i = 0; i < mList.size(); i++) {				MenuItem mi = mList.get(i);				if(mi.quality>0) {					tt+=(mi.quality*mi.price);				}			}			Log.i("Tuan", "Total "+tt);			menuSupplier.total = tt;			total.setText("$"+tt);			Log.i("Tuan", "TTT "+menuSupplier.toJSONString());			super.notifyDataSetChanged();		}	}	static class MyHolder {		ImageView btn_minus;		ImageView btn_plus;		LinearLayout layout;		TextView price;		TextView quality;		TextView title;	}}